<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DESI focal plane 360 panoramas</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css"/>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js"></script>
    <style>
    #panorama {
        width: 800px;
        height: 800px;
    }
    .custom-hotspot {
        height: 30px;
        width: 30px;
        border: 4px solid #f00;
        border-radius: 8px;
    }
    div.custom-tooltip span {
        visibility: hidden;
        position: absolute;
        border-radius: 3px;
        background-color: #fff;
        color: #000;
        text-align: center;
        font-size: 12px;
        max-width: 200px;
        padding: 5px 10px;
        margin-left: -220px;
        cursor: default;
    }
    div.custom-tooltip:hover span{
        visibility: visible;
    }
    div.custom-tooltip:hover span:after {
        content: '';
        position: absolute;
        width: 0;
        height: 0;
        border-width: 10px;
        border-style: solid;
        border-color: #fff transparent transparent transparent;
        bottom: -20px;
        left: -10px;
        margin: 0 50%;
    }
    </style>
</head>
<body>
    <p>
        Welcome to the <a href="https://www.desi.lbl.gov/">DESI</a> focal plane, home to 5000 robotic eyes that are creating the most detailed 3D map of the universe ever.
        Use the buttons below to zoom in and out, or view the panorama in fullscreen mode (recommended). Use the mouse or touch to look around this 360° panorama.
    </p>
    <div id="panorama"></div>
    <script>
    pannellum.viewer('panorama', {
        "default": {
            "firstScene": "parked",
            "author": "David Kirkby / UC Irvine",
            "sceneFadeDuration": 1000,
            "autoLoad": true,
            "hfov": 90,
            "hotSpotDebug": true
        },
        "scenes": {
            "parked": {
                "title": "DESI robots parked for the day",
                "type": "equirectangular",
                "panorama": "img/DESI3D-1.jpg",
                "hotSpots": [
                    {
                        "pitch": 4.5,
                        "yaw": -29.5,
                        "cssClass": "custom-hotspot",
                        "createTooltipFunc": hotspot,
                        "createTooltipArgs": "DESI is located on Kitt Peak, in the Tohono Oʼodham Nation, above the Arizona-Sonoran Desert 88 km (55 mi) west of Tucson, Arizona"
                    },
                    {
                        "pitch": -90,
                        "yaw": 0,
                        "cssClass": "custom-hotspot",
                        "createTooltipFunc": hotspot,
                        "createTooltipArgs": "The DESI focal plane is home to 5000 robotic eyes arranged into 10 pizza slices"
                    },
                    {
                        "pitch": -38.5,
                        "yaw": -13.0,
                        "cssClass": "custom-hotspot",
                        "createTooltipFunc": hotspot,
                        "createTooltipArgs": "Towers called fiducials create a reference grid to precisely align the 5000 robots"
                    },
                    {
                        "pitch": -41.5,
                        "yaw": 3,
                        "cssClass": "custom-hotspot",
                        "createTooltipFunc": hotspot,
                        "createTooltipArgs": "Each robot is about the size of a pencil and precisely positions a fiber to capture the light from a distant star or galaxy"
                    },
                    {
                        "pitch": 32,
                        "yaw": -27,
                        "cssClass": "custom-hotspot",
                        "createTooltipFunc": hotspot,
                        "createTooltipArgs": "Most of the light in the night sky is from stars in the Milky Way but DESI concentrates on faint galaxies in the distant universe"
                    },
                    {
                        "pitch": -5,
                        "yaw": 0,
                        "type": "scene",
                        "text": "Move the robots",
                        "sceneId": "unparked"
                    }
                ]
            },
            "unparked": {
                "title": "DESI robots positioned to observe the sky",
                "type": "equirectangular",
                "panorama": "img/DESI3D-2.jpg",
                "hotSpots": [
                    {
                        "pitch": 4.5,
                        "yaw": -29.5,
                        "cssClass": "custom-hotspot",
                        "createTooltipFunc": hotspot,
                        "createTooltipArgs": "DESI is located on Kitt Peak, in the Tohono Oʼodham Nation, above the Arizona-Sonoran Desert 88 km (55 mi) west of Tucson, Arizona."
                    },
                    {
                        "pitch": -90,
                        "yaw": 0,
                        "cssClass": "custom-hotspot",
                        "createTooltipFunc": hotspot,
                        "createTooltipArgs": "The DESI focal plane is home to 5000 robotic eyes arranged into 10 pizza slices."
                    },
                    {
                        "pitch": -38.5,
                        "yaw": -13.0,
                        "cssClass": "custom-hotspot",
                        "createTooltipFunc": hotspot,
                        "createTooltipArgs": "Towers called fiducials create a reference grid to precisely align the 5000 robots."
                    },
                    {
                        "pitch": -41.5,
                        "yaw": 3,
                        "cssClass": "custom-hotspot",
                        "createTooltipFunc": hotspot,
                        "createTooltipArgs": "Each robot is about the size of a pencil and precisely positions a fiber to capture the light from a distant star or galaxy."
                    },
                    {
                        "pitch": 32,
                        "yaw": -27,
                        "cssClass": "custom-hotspot",
                        "createTooltipFunc": hotspot,
                        "createTooltipArgs": "Most of the light in the night sky is from stars in the Milky Way but DESI concentrates on faint galaxies in the distant universe"
                    },
                    {
                        "pitch": -5,
                        "yaw": 0,
                        "type": "scene",
                        "text": "Park the robots",
                        "sceneId": "parked"
                    },
                    {
                        "pitch": -5.5,
                        "yaw": 18,
                        "type": "scene",
                        "text": "Take a closer look",
                        "sceneId": "closer"
                    }
                ]
            },
            "closer": {
                "title": "A closer look at the DESI focal plane",
                "type": "equirectangular",
                "panorama": "img/DESI3D-4.jpg",
                "pitch": -43,
                "yaw": 0,
                "hotSpots": [
                    {
                        "pitch": -28.5,
                        "yaw": 15.2,
                        "cssClass": "custom-hotspot",
                        "createTooltipFunc": hotspot,
                        "createTooltipArgs": "Each fiber is about the size of a human hair and must be positioned to a fraction of a hair's width to capture the light from a distant star or galaxy"
                    },
                    {
                        "pitch": -55,
                        "yaw": -27,
                        "cssClass": "custom-hotspot",
                        "createTooltipFunc": hotspot,
                        "createTooltipArgs": "Each fiber is about 40 meters long and carries the light from a distant star or galaxy to the DESI spectrographs"
                    },
                    {
                        "pitch": -17,
                        "yaw": -28.7,
                        "cssClass": "custom-hotspot",
                        "createTooltipFunc": hotspot,
                        "createTooltipArgs": "Robot movement is carefully choreographed to avoid collisions between neighbors"
                    },
                    {
                        "pitch": -2,
                        "yaw": 0,
                        "type": "scene",
                        "text": "Go back",
                        "sceneId": "unparked"
                    },
                    {
                        "pitch": -43,
                        "yaw": 0,
                        "type": "scene",
                        "text": "Dive into the robots",
                        "sceneId": "dive"
                    }
                ]
            },
            "dive": {
                "title": "Among the DESI robots",
                "type": "equirectangular",
                "panorama": "img/DESI360-5.jpg",
                "hotSpots": [
                    {
                        "pitch": 40,
                        "yaw": 0,
                        "type": "scene",
                        "text": "Go back",
                        "sceneId": "closer"
                    },
                    {
                        "pitch": -43,
                        "yaw": 0,
                        "type": "scene",
                        "text": "Go even deeper",
                        "sceneId": "bottom"
                    }
                ]
            },
            "bottom": {
                "title": "At the base of the DESI robots",
                "type": "equirectangular",
                "panorama": "img/DESI360-7.jpg",
                "pitch": 62,
                "yaw": 21,
                "hotSpots": [
                    {
                        "pitch": 85,
                        "yaw": 162,
                        "cssClass": "custom-hotspot",
                        "createTooltipFunc": hotspot,
                        "createTooltipArgs": "Light from the most distant objects has traveled for over 10 billion years to reach DESI"
                    },
                    {
                        "pitch": 27,
                        "yaw": 9.5,
                        "cssClass": "custom-hotspot",
                        "createTooltipFunc": hotspot,
                        "createTooltipArgs": "Robots use a pair of tiny motors to position their fibers"
                    },
                    {
                        "pitch": 83,
                        "yaw": 25,
                        "type": "scene",
                        "text": "Go back",
                        "sceneId": "dive"
                    }
                ]
            }
        }
    });
    function hotspot(hotSpotDiv, args) {
        hotSpotDiv.classList.add('custom-tooltip');
        var span = document.createElement('span');
        span.innerHTML = args;
        hotSpotDiv.appendChild(span);
        span.style.width = span.scrollWidth - 20 + 'px';
        span.style.marginLeft = -(span.scrollWidth - hotSpotDiv.offsetWidth) / 2 + 'px';
        span.style.marginTop = -span.scrollHeight - 12 + 'px';
    }
    </script>
</body>
</html>